{% extends "admin/change_list.html" %}
{% load i18n admin_urls static %}

{% block extrastyle %}
  {{ block.super }}
  <style>
    /* Modern Export Excel Button */
    .object-tools .exportlink {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 20px;
      background: #28a745;
      color: #fff !important;
      text-decoration: none;
      font-weight: 500;
      font-size: 14px;
      border-radius: 4px;
      border: none;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      transition: all 0.2s ease;
      vertical-align: middle;
      margin-left: 8px;
    }
    .object-tools .exportlink:hover { 
      background: #218838;
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
      transform: translateY(-1px);
    }
    .object-tools .exportlink:active { 
      transform: translateY(0);
      box-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }
    .object-tools .exportlink::before { content: none !important; display: none !important; }

    .book-admin-enhancements {
        margin: 10px 0;
    }
    
    .book-stats {
        background: #f8f9fa;
        border: 1px solid #dee2e6;
        border-radius: 4px;
        padding: 15px;
        margin-bottom: 20px;
    }
    
    .book-stats h3 {
        margin-top: 0;
        color: #495057;
    }
    
    .stat-item {
        display: inline-block;
        margin-right: 20px;
        padding: 5px 10px;
        background: #e9ecef;
        border-radius: 3px;
        color: #495057;
    }
    
    .stat-value {
        font-weight: bold;
        color: #007cba;
    }
    
    .admin-book-help {
        background: #e7f3ff;
        border-left: 4px solid #007cba;
        padding: 10px 15px;
        margin: 10px 0;
        border-radius: 0 4px 4px 0;
    }
    
    .admin-book-help h4 {
        margin-top: 0;
        color: #007cba;
    }
    
    .help-list {
        margin: 5px 0 0 20px;
        color: #666;
    }

    /* Enhanced changelist styling */
    .results tbody tr:hover {
      background-color: #f5f5f5;
    }

    .results .field-get_authors a,
    .results .field-publisher a {
      color: #007cba;
      font-weight: 500;
    }
  </style>
{% endblock %}

{% block content_title %}
  Books Management
{% endblock %}

{% block object-tools-items %}
  {{ block.super }}
  <a href="{% url 'admin-export-books' %}?{{ request.GET.urlencode }}" 
     class="exportlink" 
     title="Export to Excel">
    Export Excel
  </a>
{% endblock %}

{% block result_list %}
{{ block.super }}

<script>
// Load additional stats via AJAX (if endpoints exist)
document.addEventListener('DOMContentLoaded', function() {
    // These would be populated from actual endpoints in a real implementation
    // For now, we'll just update them with placeholder values
    setTimeout(function() {
        const authorsEl = document.getElementById('total-authors');
        const itemsEl = document.getElementById('total-items');
        const categoriesEl = document.getElementById('total-categories');
        
        if (authorsEl) authorsEl.textContent = '{{ total_authors|default:"?" }}';
        if (itemsEl) itemsEl.textContent = '{{ total_items|default:"?" }}';
        if (categoriesEl) categoriesEl.textContent = '{{ total_categories|default:"?" }}';
    }, 100);
});
</script>
{% endblock %}