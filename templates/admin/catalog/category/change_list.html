{% extends "admin/change_list.html" %}
{% load admin_urls static %}

{% block extrastyle %}
  {{ block.super }}
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    /* Enhanced styling for category admin */
    .object-tools .exportlink {
      display: inline-flex;
      align-items: center;
      gap: .35rem;
      padding: 8px 15px;
      border-radius: 6px;
      background: linear-gradient(135deg, #10b981, #059669);
      color: #fff !important;
      text-decoration: none;
      font-weight: 600;
      font-size: 13px;
      line-height: 1;
      white-space: nowrap;
      border: 1px solid #047857;
      box-shadow: 0 1px 2px rgba(0,0,0,0.08), inset 0 -2px 0 rgba(0,0,0,0.12);
      transition: transform .02s ease, box-shadow .2s ease, filter .2s ease;
      vertical-align: middle;
      margin-left: 5px;
    }
    .object-tools .exportlink:hover { 
      filter: brightness(1.05); 
      box-shadow: 0 3px 10px rgba(16,185,129,0.35); 
    }
    .object-tools .exportlink:active { transform: translateY(1px); }
    .object-tools .exportlink::before { content: none !important; display: none !important; }

    /* Enhanced changelist styling */
    .results tbody tr:hover {
      background-color: #f5f5f5;
    }

    .results .field-books_count a {
      color: #007cba;
      font-weight: 600;
    }

    .results .field-children_count {
      font-style: italic;
    }
  </style>
{% endblock %}

{% block content_title %}
  Categories Management
{% endblock %}

{% block result_list %}
  {{ block.super }}
{% endblock %}

{% block object-tools-items %}
  {{ block.super }}
  <a href="{% url 'admin_export_categories_excel' %}?{{ request.GET.urlencode }}" 
     class="exportlink" 
     title="Export categories to Excel">
    <i class="fa-solid fa-file-excel"></i>
    Export Excel
  </a>
  <a href="{% url 'admin_category_export_api' %}?{{ request.GET.urlencode }}" 
     class="exportlink" 
     style="background: linear-gradient(135deg, #6f42c1, #5a31a7); border-color: #5a31a7;"
     title="Export categories to JSON">
    <i class="fa-solid fa-file-code"></i>
    Export JSON
  </a>
{% endblock %}

{% block extrajs %}
  {{ block.super }}
  <script>
  document.addEventListener('DOMContentLoaded', function() {
    // Add icons to action buttons if not present
    const actionSelect = document.querySelector('select[name="action"]');
    if (actionSelect) {
      Array.from(actionSelect.options).forEach(option => {
        if (option.value.includes('clear_parent')) {
          option.text = 'ðŸ”¼ ' + option.text;
        } else if (option.value.includes('make_parent')) {
          option.text = 'ðŸ‘¥ ' + option.text;
        }
      });
    }
  });
  </script>
{% endblock %}